-- Добавление нового клиента
CREATE PROCEDURE ДобавитьКлиента
	@ID_заказчика int,
    @Наименование_фирмы_заказчика nvarchar(50),
    @Адрес nvarchar(50),
    @Телефон int,
    @Контактное_лицо nvarchar(50)
AS
BEGIN
    INSERT INTO КЛИЕНТЫ (id_клиента, Наименование_фирмы_заказчика, Адрес, Телефон, Контактное_лицо)
    VALUES (@ID_заказчика, @Наименование_фирмы_заказчика, @Адрес, @Телефон, @Контактное_лицо)
END;
drop procedure ДобавитьКлиента
-- Вызов процедуры для добавления клиента
EXEC ДобавитьКлиента 102, 'ООО одуванчик', 'ул. Ленина, 10', 123456789, 'Иванов Иван';

-- Добавление нового товара
CREATE PROCEDURE ДобавитьТовар
	@ID_товара int,
    @Наименоввание_товара nvarchar(50),
    @Цена int,
    @Описание_товара nvarchar(50)
AS
BEGIN
    INSERT INTO ТОВАРЫ (id_товара, Наименование_товара, Цена, Описание_товара)
    VALUES (@ID_товара, @Наименоввание_товара, @Цена, @Описание_товара)
END;

-- Вызов процедуры для добавления товара
EXEC ДобавитьТовар '102', 'Ноутбук', 50000, 'Игровой ноутбук';
drop procedure ДобавитьТовар
-- Добавление нового заказа
CREATE PROCEDURE ДобавитьЗаказ
	@id_заказа int,
    @id_клиента int,
    @id_товара int,
    @Количество int,
    @Дата_поставки date,
    @Вид_доставки nvarchar(50)
AS
BEGIN
    INSERT INTO ЗАКАЗЫ (id_заказа, id_клиента, id_товара, Количество, Дата_поставки, Вид_доставки)
    VALUES (@id_заказа, @id_клиента, @id_товара, @Количество, @Дата_поставки, @Вид_доставки)
END;
drop procedure ДобавитьЗаказ
-- Вызов процедуры для добавления заказа
EXEC ДобавитьЗаказ 101, 2, 1, 10, '2025-01-20', 'Курьер';

-- Обновление данных о клиенте
CREATE PROCEDURE ОбновитьКлиента
    @id_клиента int,
    @Адрес nvarchar(50),
    @Телефон int
AS
BEGIN
    UPDATE КЛИЕНТЫ
    SET Адрес = @Адрес, Телефон = @Телефон
    WHERE id_клиента = @id_клиента
END;

-- Вызов процедуры для обновления клиента
EXEC ОбновитьКлиента 1, 'ул. Кирова, 15', 987654321;

-- Удаление клиента (сначала удаляем заказы, затем клиента)
CREATE PROCEDURE УдалитьКлиента
    @id_клиента int
AS
BEGIN
    DELETE FROM ЗАКАЗЫ WHERE id_клиента = @id_клиента;
    DELETE FROM КЛИЕНТЫ WHERE id_клиента = @id_клиента;
END;

-- Вызов процедуры для удаления клиента
EXEC УдалитьКлиента 1;

-- Получение всех заказов для клиента
CREATE PROCEDURE ПолучитьЗаказыКлиента
    @id_клиента int
AS
BEGIN
    SELECT Z.id_заказа, T.Наименование_товара, Z.Количество, Z.Дата_поставки, Z.Вид_доставки
    FROM ЗАКАЗЫ Z
    JOIN ТОВАРЫ T ON Z.id_товара = T.id_товара
    WHERE Z.id_клиента = @id_клиента
END;

-- Вызов процедуры для получения заказов клиента
EXEC ПолучитьЗаказыКлиента 2;
